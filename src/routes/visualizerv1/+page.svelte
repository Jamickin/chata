<!-- Additional Information Section -->
<div class="bg-gradient-to-b from-slate-50 to-white dark:from-slate-800 dark:to-slate-700 p-6 border-t border-slate-200 dark:border-slate-700 shadow-inner">
	<div class="max-w-5xl mx-auto">
		<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
			<div class="bg-white dark:bg-slate-800/50 p-5 rounded-lg shadow-sm transform transition-all duration-300 hover:shadow">
				<h3 class="text-lg font-semibold bg-gradient-to-r from-blue-600 to-indigo-600 dark:from-blue-400 dark:to-indigo-400 bg-clip-text text-transparent mb-3 flex items-center">
					<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-blue-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
					</svg>
					Using This Visualizer
				</h3>
				<p class="text-slate-600 dark:text-slate-300 mb-3 leading-relaxed">
					This day visualizer helps you plan your time effectively with a visual representation of your daily schedule.
				</p>
				<ul class="space-y-2 text-slate-600 dark:text-slate-300">
					<li class="flex items-start transition-all duration-300 hover:translate-x-1">
						<div class="flex-shrink-0 w-6 h-6 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center mr-2">
							<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-blue-500" viewBox="0 0 20 20" fill="currentColor">
								<path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
							</svg>
						</div>
						<span>Adjust the sliders to set your work, break, and sleep hours.</span>
					</li>
					<li class="flex items-start transition-all duration-300 hover:translate-x-1">
						<div class="flex-shrink-0 w-6 h-6 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center mr-2">
							<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-blue-500" viewBox="0 0 20 20" fill="currentColor">
								<path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
							</svg>
						</div>
						<span>The circle visualization shows your day divided into time segments.</span>
					</li>
					<li class="flex items-start transition-all duration-300 hover:translate-x-1">
						<div class="flex-shrink-0 w-6 h-6 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center mr-2">
							<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-blue-500" viewBox="0 0 20 20" fill="currentColor">
								<path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
							</svg>
						</div>
						<span>Red warnings appear when you don't have enough time for all planned activities.</span>
					</li>
				</ul>
			</div>
			
			<div class="bg-white dark:bg-slate-800/50 p-5 rounded-lg shadow-sm transform transition-all duration-300 hover:shadow">
				<h3 class="text-lg font-semibold bg-gradient-to-r from-purple-600 to-pink-600 dark:from-purple-400 dark:to-pink-400 bg-clip-text text-transparent mb-3 flex items-center">
					<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-purple-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4" />
					</svg>
					About Time Management
				</h3>
				<p class="text-slate-600 dark:text-slate-300 mb-3 leading-relaxed">
					Effective time management reduces stress, increases productivity, and improves work-life balance.
				</p>
				<ul class="space-y-2 text-slate-600 dark:text-slate-300">
					<li class="flex items-start transition-all duration-300 hover:translate-x-1">
						<div class="flex-shrink-0 w-6 h-6 rounded-full bg-purple-100 dark:bg-purple-900/30 flex items-center justify-center mr-2">
							<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-purple-500" viewBox="0 0 20 20" fill="currentColor">
								<path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
							</svg>
						</div>
						<span>Adults need 7-9 hours of sleep for optimal cognitive function.</span>
					</li>
					<li class="flex items-start transition-all duration-300 hover:translate-x-1">
						<div class="flex-shrink-0 w-6 h-6 rounded-full bg-purple-100 dark:bg-purple-900/30 flex items-center justify-center mr-2">
							<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-purple-500" viewBox="0 0 20 20" fill="currentColor">
								<path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
							</svg>
						</div>
						<span>Taking breaks increases overall productivity and helps maintain focus.</span>
					</li>
					<li class="flex items-start transition-all duration-300 hover:translate-x-1">
						<div class="flex-shrink-0 w-6 h-6 rounded-full bg-purple-100 dark:bg-purple-900/30 flex items-center justify-center mr-2">
							<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-purple-500" viewBox="0 0 20 20" fill="currentColor">
								<path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
							</svg>
						</div>
						<span>Most people can focus deeply for only 4-5 hours per day.</span>
					</li>
				</ul>
			</div>
		</div>
		
		<div class="mt-6 text-center text-sm bg-gradient-to-r from-indigo-50 to-purple-50 dark:from-indigo-900/10 dark:to-purple-900/10 p-3 rounded-lg shadow-sm">
			<p class="text-slate-600 dark:text-slate-400 flex items-center justify-center">
				<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
					<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
				</svg>
				Visualization updates automatically every minute. Last updated at {currentTime.toLocaleTimeString()}
			</p>
		<script>
import { onMount } from 'svelte';
import AnimatedBackground from '$lib/components/AnimatedBackground.svelte';

// User inputs with defaults
let workHoursNeeded = $state(8); // Hours of work to complete
let breakTimeWanted = $state(2); // Hours of break time desired
let sleepHours = $state(8); // Hours of sleep
let bedTime = $state('23:00'); // Time to go to bed
let wakeTime = $state('07:00'); // Time to wake up
let currentTime = $state(new Date()); // Current time
let colorScheme = $state('blue'); // Can be blue, purple, green, amber, pink
let theme = $state('light'); // light or dark

// Derived values
let hoursInDay = 24;
let hoursLeft = $state(0);
let segments = $state([]);
let timeBlocks = $state([]);
let progress = $state(0);

// Color schemes for different themes and priorities
const colorPalette = {
	light: {
		blue: {
			work: '#4682B4',
			break: '#90EE90',
			sleep: '#9370DB',
			past: '#D3D3D3',
			urgent: '#FF6347',
			untilBed: '#FFD700'
		},
		purple: {
			work: '#8A2BE2',
			break: '#98FB98',
			sleep: '#DDA0DD',
			past: '#D8BFD8',
			urgent: '#FF4500',
			untilBed: '#DAA520'
		},
		green: {
			work: '#2E8B57',
			break: '#98FB98',
			sleep: '#87CEFA',
			past: '#D3D3D3',
			urgent: '#FF6347',
			untilBed: '#F0E68C'
		}
	},
	dark: {
		blue: {
			work: '#6495ED',
			break: '#3CB371',
			sleep: '#9370DB',
			past: '#696969',
			urgent: '#FF6347',
			untilBed: '#DAA520'
		},
		purple: {
			work: '#9932CC',
			break: '#3CB371',
			sleep: '#DDA0DD',
			past: '#696969',
			urgent: '#FF4500',
			untilBed: '#DAA520'
		},
		green: {
			work: '#3CB371',
			break: '#98FB98',
			sleep: '#4682B4',
			past: '#696969',
			urgent: '#FF6347',
			untilBed: '#F0E68C'
		}
	}
};

// Parse time string (HH:MM) to date object
function parseTimeToDate(timeString, date = new Date()) {
	const [hours, minutes] = timeString.split(':').map(Number);
	const result = new Date(date);
	result.setHours(hours, minutes, 0, 0);
	return result;
}

// Determine if a time is between two other times (handles overnight periods)
function isTimeBetween(time, start, end) {
	if (end < start) {
		// Overnight period
		return time >= start || time < end;
	}
	return time >= start && time < end;
}

// Format hours to hours and minutes
function formatHours(hours) {
	const h = Math.floor(hours);
	const m = Math.round((hours - h) * 60);
	return `${h}h ${m}m`;
}

// Calculate angle for the arc based on hours (180 degrees = 12 hours)
function calculateAngle(hours) {
	return (hours / 12) * 180;
}

// Generate SVG path for an arc
function describeArc(x, y, radius, startAngle, endAngle) {
	const start = polarToCartesian(x, y, radius, endAngle);
	const end = polarToCartesian(x, y, radius, startAngle);
	const largeArcFlag = endAngle - startAngle <= 180 ? '0' : '1';

	return ['M', start.x, start.y, 'A', radius, radius, 0, largeArcFlag, 0, end.x, end.y].join(' ');
}

function polarToCartesian(centerX, centerY, radius, angleInDegrees) {
	const angleInRadians = ((angleInDegrees - 90) * Math.PI) / 180.0;
	return {
		x: centerX + radius * Math.cos(angleInRadians),
		y: centerY + radius * Math.sin(angleInRadians)
	};
}

// Update the time visualization
function updateTimeVisualization() {
	const now = currentTime;
	const startOfDay = new Date(now);
	startOfDay.setHours(0, 0, 0, 0);

	const endOfDay = new Date(startOfDay);
	endOfDay.setHours(24, 0, 0, 0);

	// Parse bed and wake times for today
	const bedTimeToday = parseTimeToDate(bedTime);
	const wakeTimeToday = parseTimeToDate(wakeTime);

	// Calculate total available waking hours
	let wakingHours;
	if (wakeTimeToday < bedTimeToday) {
		// Normal schedule (wake in morning, sleep at night)
		wakingHours = (bedTimeToday - wakeTimeToday) / (1000 * 60 * 60);
	} else {
		// Reverse schedule (night shift worker, etc.)
		wakingHours = 24 - (wakeTimeToday - bedTimeToday) / (1000 * 60 * 60);
	}

	// Calculate hours passed in the day
	const hoursPassed = (now - startOfDay) / (1000 * 60 * 60);
	
	// Update progress circle
	progress = (hoursPassed / 24) * 100;

	// Calculate hours left in the day
	hoursLeft = 24 - hoursPassed;

	// Calculate time left before bed
	let hoursBeforeBed;
	if (now < bedTimeToday) {
		hoursBeforeBed = (bedTimeToday - now) / (1000 * 60 * 60);
	} else {
		// Already past bedtime
		hoursBeforeBed = 0;
	}

	// Calculate if we're in sleep time
	const inSleepTime =
		isTimeBetween(now, bedTimeToday, wakeTimeToday) ||
		(bedTimeToday < wakeTimeToday && (now >= bedTimeToday || now < wakeTimeToday));

	// Calculate remaining work and break time
	const remainingActiveHours = Math.max(0, hoursBeforeBed);
	const workAndBreakNeeded = workHoursNeeded + breakTimeWanted;

	// Determine if there's enough time for all planned activities
	const timeDeficit = Math.max(0, workAndBreakNeeded - remainingActiveHours);

	// Adjust work and break time proportionally if there's a deficit
	let adjustedWorkHours = workHoursNeeded;
	let adjustedBreakHours = breakTimeWanted;

	if (timeDeficit > 0) {
		const reductionFactor = remainingActiveHours / workAndBreakNeeded;
		adjustedWorkHours = workHoursNeeded * reductionFactor;
		adjustedBreakHours = breakTimeWanted * reductionFactor;
	}

	// Create segments for day visualization
	segments = [
		{
			type: 'past',
			hours: hoursPassed,
			color: colorPalette[theme][colorScheme].past,
			label: 'Past',
			startAngle: 0,
			endAngle: calculateAngle(hoursPassed > 12 ? 12 : hoursPassed)
		}
	];

	// Add night segment if we're in the second half of the day
	if (hoursPassed > 12) {
		segments.push({
			type: 'past-night',
			hours: hoursPassed - 12,
			color: colorPalette[theme][colorScheme].past,
			label: 'Past (Night)',
			startAngle: 180,
			endAngle: 180 + calculateAngle(hoursPassed - 12)
		});
	}

	// Create time blocks for planning
	timeBlocks = [];

	// Current status block
	timeBlocks.push({
		type: inSleepTime ? 'sleeping' : 'awake',
		label: inSleepTime ? 'Currently Sleeping' : 'Currently Awake',
		color: inSleepTime ? colorPalette[theme][colorScheme].sleep : colorPalette[theme][colorScheme].work,
		hours: 0, // Current state, not hours
		urgent: false
	});

	// Remaining tasks blocks
	if (!inSleepTime) {
		if (timeDeficit > 0) {
			timeBlocks.push({
				type: 'warning',
				label: `Time Deficit`,
				color: colorPalette[theme][colorScheme].urgent,
				hours: timeDeficit,
				formatted: formatHours(timeDeficit),
				urgent: true
			});
		}

		timeBlocks.push({
			type: 'work',
			label: 'Work Time Available',
			color: colorPalette[theme][colorScheme].work,
			hours: adjustedWorkHours,
			formatted: formatHours(adjustedWorkHours),
			urgent: false
		});

		timeBlocks.push({
			type: 'break',
			label: 'Break Time Available',
			color: colorPalette[theme][colorScheme].break,
			hours: adjustedBreakHours,
			formatted: formatHours(adjustedBreakHours),
			urgent: false
		});

		timeBlocks.push({
			type: 'until-bed',
			label: 'Time Until Bed',
			color: colorPalette[theme][colorScheme].untilBed,
			hours: hoursBeforeBed,
			formatted: formatHours(hoursBeforeBed),
			urgent: hoursBeforeBed < 1
		});
	}

	// Sleep block
	timeBlocks.push({
		type: 'sleep',
		label: 'Sleep Time',
		color: colorPalette[theme][colorScheme].sleep,
		hours: sleepHours,
		formatted: formatHours(sleepHours),
		urgent: false
	});
}

// Update visualization whenever any inputs change
$effect(() => {
	updateTimeVisualization();
	// Explicitly trigger update when any of these values change
	workHoursNeeded;
	breakTimeWanted;
	sleepHours;
	bedTime;
	wakeTime;
	theme;
	colorScheme;
});

// Auto-update current time
onMount(() => {
	// Update immediately
	updateTimeVisualization();
	
	// Then update every minute
	const interval = setInterval(() => {
		currentTime = new Date();
		updateTimeVisualization();
	}, 60000);

	return () => clearInterval(interval);
});

// Generate circular markers
function generateMarkers(count, radius) {
	const markers = [];
	const circumference = 2 * Math.PI * radius;
	const spacing = circumference / count;

	for (let i = 0; i < count; i++) {
		const angle = (i / count) * 360;
		const coords = polarToCartesian(250, 250, radius, angle);
		markers.push({
			x: coords.x,
			y: coords.y,
			active: i < Math.ceil(workHoursNeeded)
		});
	}

	return markers;
}

// Generate hour markers
const hourMarkers = Array.from({ length: 24 }, (_, i) => ({
	hour: i,
	angle: (i / 24) * 360,
	label: i.toString().padStart(2, '0') + ':00'
}));

// Generate markers for work/break units
$effect(() => {
	workMarkers = generateMarkers(Math.ceil(workHoursNeeded + breakTimeWanted), 160);
});

let workMarkers = [];

// Toggle dark/light theme
function toggleTheme() {
	theme = theme === 'light' ? 'dark' : 'light';
	updateTimeVisualization();
}

// Change color scheme
function changeColorScheme(newScheme) {
	colorScheme = newScheme;
	updateTimeVisualization();
}
</script>

<div class="day-visualizer bg-white dark:bg-slate-800 rounded-xl shadow-lg border border-slate-200 dark:border-slate-700 overflow-hidden transition-all duration-300 transform hover:shadow-xl">
<div class="p-6">
	<div class="flex justify-between items-center mb-6">
		<h2 class="text-2xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 dark:from-indigo-400 dark:to-purple-400 bg-clip-text text-transparent">Your Day Visualizer</h2>
		
		<div class="flex gap-3">
			<div class="flex items-center space-x-1">
				<button 
					class="w-4 h-4 rounded-full bg-blue-500 border-2 border-transparent hover:border-slate-800 dark:hover:border-white transition-all duration-200 {colorScheme === 'blue' ? 'ring-2 ring-blue-300 ring-offset-2 ring-offset-white dark:ring-offset-slate-800' : ''}"
					on:click={() => changeColorScheme('blue')}
					aria-label="Blue theme"
				></button>
				<button 
					class="w-4 h-4 rounded-full bg-purple-500 border-2 border-transparent hover:border-slate-800 dark:hover:border-white transition-all duration-200 {colorScheme === 'purple' ? 'ring-2 ring-purple-300 ring-offset-2 ring-offset-white dark:ring-offset-slate-800' : ''}"
					on:click={() => changeColorScheme('purple')}
					aria-label="Purple theme"
				></button>
				<button 
					class="w-4 h-4 rounded-full bg-green-500 border-2 border-transparent hover:border-slate-800 dark:hover:border-white transition-all duration-200 {colorScheme === 'green' ? 'ring-2 ring-green-300 ring-offset-2 ring-offset-white dark:ring-offset-slate-800' : ''}"
					on:click={() => changeColorScheme('green')}
					aria-label="Green theme"
				></button>
			</div>
			
			<button 
				class="p-2 rounded-full bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 transition-all duration-300 shadow-sm"
				on:click={toggleTheme}
				aria-label="Toggle theme"
			>
				{#if theme === 'light'}
					<!-- Moon icon -->
					<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-slate-700 dark:text-slate-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
					</svg>
				{:else}
					<!-- Sun icon -->
					<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-slate-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
					</svg>
				{/if}
			</button>
		</div>
	</div>

	<div class="time-info mb-6 bg-gradient-to-r from-slate-50 to-slate-100 dark:from-slate-700/30 dark:to-slate-700/50 rounded-lg p-4 text-center shadow-sm transition-all duration-500 hover:shadow">
		<p class="text-xl font-medium text-slate-800 dark:text-white">
			<span class="inline-block transform transition-all">
				{currentTime.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}
			</span>
		</p>
		<p class="text-slate-600 dark:text-slate-300 flex items-center justify-center gap-2">
			<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
				<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
			</svg>
			<span>{hoursLeft.toFixed(1)} hours left today</span>
		</p>
		<div class="mt-2 w-full h-3 bg-slate-200 dark:bg-slate-600 rounded-full overflow-hidden transition-all duration-300">
			<div 
				class="h-full bg-gradient-to-r from-blue-500 to-indigo-600 dark:from-blue-400 dark:to-indigo-500 transition-all duration-300 ease-in-out" 
				style="width: {progress}%;"
			></div>
		</div>
	</div>

	<div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
		<div class="inputs-container bg-white dark:bg-slate-800 rounded-lg p-6 shadow-sm hover:shadow-md transition-all duration-300 border border-slate-100 dark:border-slate-700">
			<h3 class="text-lg font-semibold text-slate-800 dark:text-white mb-4 flex items-center">
				<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-indigo-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
					<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
					<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
				</svg>
				Adjust Your Day
			</h3>
			
			<div class="space-y-5">
				<div class="input-group transition-all duration-300 transform hover:translate-x-1">
					<div class="flex justify-between mb-1">
						<label for="work-hours" class="font-medium text-slate-700 dark:text-slate-300 flex items-center">
							<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 text-blue-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
							</svg>
							Work hours
						</label>
						<span class="font-bold text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/30 px-2 py-0.5 rounded-full text-sm">
							{workHoursNeeded} hrs
						</span>
					</div>
					<div class="relative">
						<input
							id="work-hours"
							type="range"
							min="0"
							max="16"
							step="0.5"
							class="slider-blue w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer dark:bg-slate-600"
							bind:value={workHoursNeeded}
						/>
						<div class="flex justify-between text-xs text-slate-500 mt-1 px-1">
							<span>0h</span>
							<span>8h</span>
							<span>16h</span>
						</div>
					</div>
				</div>

				<div class="input-group transition-all duration-300 transform hover:translate-x-1">
					<div class="flex justify-between mb-1">
						<label for="break-time" class="font-medium text-slate-700 dark:text-slate-300 flex items-center">
							<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z" />
							</svg>
							Break time
						</label>
						<span class="font-bold text-green-600 dark:text-green-400 bg-green-50 dark:bg-green-900/30 px-2 py-0.5 rounded-full text-sm">
							{breakTimeWanted} hrs
						</span>
					</div>
					<div class="relative">
						<input 
							id="break-time" 
							type="range" 
							min="0" 
							max="8" 
							step="0.5" 
							class="slider-green w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer dark:bg-slate-600"
							bind:value={breakTimeWanted} 
						/>
						<div class="flex justify-between text-xs text-slate-500 mt-1 px-1">
							<span>0h</span>
							<span>4h</span>
							<span>8h</span>
						</div>
					</div>
				</div>

				<div class="input-group transition-all duration-300 transform hover:translate-x-1">
					<div class="flex justify-between mb-1">
						<label for="sleep-hours" class="font-medium text-slate-700 dark:text-slate-300 flex items-center">
							<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 text-purple-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
							</svg>
							Sleep hours
						</label>
						<span class="font-bold text-purple-600 dark:text-purple-400 bg-purple-50 dark:bg-purple-900/30 px-2 py-0.5 rounded-full text-sm">
							{sleepHours} hrs
						</span>
					</div>
					<div class="relative">
						<input 
							id="sleep-hours" 
							type="range" 
							min="4" 
							max="12" 
							step="0.5" 
							class="slider-purple w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer dark:bg-slate-600"
							bind:value={sleepHours} 
						/>
						<div class="flex justify-between text-xs text-slate-500 mt-1 px-1">
							<span>4h</span>
							<span>8h</span>
							<span>12h</span>
						</div>
					</div>
				</div>

				<div class="grid grid-cols-2 gap-4 mt-6">
					<div class="input-group transition-all duration-300 hover:shadow-sm">
						<label for="bed-time" class="block mb-1 font-medium text-slate-700 dark:text-slate-300 flex items-center">
							<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 text-amber-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 11V9a4 4 0 014-4h14a4 4 0 014 4v9a4 4 0 01-4 4H7a4 4 0 01-4-4v-1m4-6v6" />
							</svg>
							Bedtime
						</label>
						<input 
							id="bed-time" 
							type="time" 
							class="w-full px-3 py-2 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-md focus:ring-2 focus:ring-indigo-500 dark:focus:ring-indigo-400 focus:border-transparent transition-all duration-200"
							bind:value={bedTime} 
						/>
					</div>

					<div class="input-group transition-all duration-300 hover:shadow-sm">
						<label for="wake-time" class="block mb-1 font-medium text-slate-700 dark:text-slate-300 flex items-center">
							<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 text-orange-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
							</svg>
							Wake time
						</label>
						<input 
							id="wake-time" 
							type="time" 
							class="w-full px-3 py-2 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-md focus:ring-2 focus:ring-indigo-500 dark:focus:ring-indigo-400 focus:border-transparent transition-all duration-200"
							bind:value={wakeTime}
						/>
					</div>
				</div>
			</div>
		</div>

		<div class="visualization-container">
			<svg viewBox="0 0 500 500" class="day-circle w-full h-auto">
				<!-- Day arc (top semicircle) -->
				<path 
					d="M 50 250 A 200 200 0 0 1 450 250" 
					fill="none" 
					stroke="#E0E0E0" 
					stroke-width="30"
					class="dark:stroke-slate-700" 
				/>

				<!-- Night arc (bottom semicircle) -->
				<path 
					d="M 450 250 A 200 200 0 0 1 50 250" 
					fill="none" 
					stroke="#D0D0D0" 
					stroke-width="30" 
					class="dark:stroke-slate-800"
				/>

				<!-- Time segments -->
				{#each segments as segment}
					<path
						d={describeArc(250, 250, 200, segment.startAngle, segment.endAngle)}
						fill="none"
						stroke={segment.color}
						stroke-width="30"
					/>
				{/each}

				<!-- Work/Break unit circles -->
				{#each workMarkers as marker, i}
					<circle
						cx={marker.x}
						cy={marker.y}
						r="8"
						fill={marker.active
							? i < Math.ceil(workHoursNeeded)
								? colorPalette[theme][colorScheme].work
								: colorPalette[theme][colorScheme].break
							: '#E0E0E0'}
						stroke="#FFF"
						stroke-width="2"
						class="dark:stroke-slate-800"
					>
						<animate 
							attributeName="r" 
							values="8;9;8" 
							dur="2s" 
							repeatCount="indefinite" 
							begin={i * 0.1}
						/>
					</circle>
				{/each}

				<!-- Hour markers -->
				{#each hourMarkers as marker}
					<g transform={`rotate(${marker.angle} 250 250)`}>
						<line 
							x1="250" 
							y1="50" 
							x2="250" 
							y2="70" 
							stroke="#333" 
							stroke-width="2"
							class="dark:stroke-slate-400" 
						/>
						<text
							x="250"
							y="40"
							text-anchor="middle"
							font-size="10"
							class="fill-slate-800 dark:fill-slate-300"
							transform={`rotate(${-marker.angle} 250 40)`}
						>
							{marker.label}
						</text>
					</g>
				{/each}

				<!-- Center text -->
				<text 
					x="250" 
					y="240" 
					text-anchor="middle" 
					font-size="24" 
					font-weight="bold"
					class="fill-slate-800 dark:fill-white"
				>
					{currentTime.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}
				</text>
				<text 
					x="250" 
					y="270" 
					text-anchor="middle" 
					font-size="14"
					class="fill-slate-600 dark:fill-slate-300"
				>
					{currentTime.toLocaleDateString()}
				</text>
			</svg>
		</div>
	</div>


		<div class="visualization-container relative">
			<div class="absolute inset-0 bg-gradient-to-br from-white/10 to-slate-50/20 dark:from-slate-800/10 dark:to-slate-900/20 rounded-lg z-0"></div>
			
			<svg viewBox="0 0 500 500" class="day-circle w-full h-auto z-10 relative">
				<!-- Inner glowing ring -->
				<circle cx="250" cy="250" r="190" fill="none" stroke-width="1" stroke-opacity="0.5" class="animate-pulse-slow stroke-blue-300 dark:stroke-blue-700"></circle>
				
				<!-- Day arc (top semicircle) -->
				<path 
					d="M 50 250 A 200 200 0 0 1 450 250" 
					fill="none" 
					stroke="#E0E0E0" 
					stroke-width="30"
					class="dark:stroke-slate-700 transition-all duration-500" 
				/>

				<!-- Night arc (bottom semicircle) -->
				<path 
					d="M 450 250 A 200 200 0 0 1 50 250" 
					fill="none" 
					stroke="#D0D0D0" 
					stroke-width="30" 
					class="dark:stroke-slate-800 transition-all duration-500"
				/>

				<!-- Time segments with animation -->
				{#each segments as segment, i}
					<path
						d={describeArc(250, 250, 200, segment.startAngle, segment.endAngle)}
						fill="none"
						stroke={segment.color}
						stroke-width="30"
						class="transition-all duration-700"
						style="transition-delay: {i * 150}ms;"
					/>
				{/each}

				<!-- Work/Break unit circles -->
				{#each workMarkers as marker, i}
					<circle
						cx={marker.x}
						cy={marker.y}
						r="8"
						fill={marker.active
							? i < Math.ceil(workHoursNeeded)
								? colorPalette[theme][colorScheme].work
								: colorPalette[theme][colorScheme].break
							: theme === 'light' ? '#E0E0E0' : '#4B5563'}
						stroke={theme === 'light' ? "#FFF" : "#1F2937"}
						stroke-width="2"
						class="transition-all duration-300"
					>
						<animate 
							attributeName="r" 
							values="8;9;8" 
							dur="2s" 
							repeatCount="indefinite" 
							begin={i * 0.1}
						/>
						<animate 
							attributeName="opacity" 
							values="0;1" 
							dur="500ms" 
							fill="freeze"
							begin="0s"
						/>
					</circle>
				{/each}

				<!-- Hour markers -->
				{#each hourMarkers as marker}
					<g transform={`rotate(${marker.angle} 250 250)`} class="transition-colors duration-300">
						<line 
							x1="250" 
							y1="50" 
							x2="250" 
							y2="70" 
							stroke="#333" 
							stroke-width="1.5"
							class="dark:stroke-slate-400 transition-colors duration-300" 
						/>
						<text
							x="250"
							y="40"
							text-anchor="middle"
							font-size="10"
							class="fill-slate-800 dark:fill-slate-300 transition-colors duration-300"
							transform={`rotate(${-marker.angle} 250 40)`}
						>
							{marker.label}
						</text>
					</g>
				{/each}

				<!-- Center circle with glow effect -->
				<circle 
					cx="250" 
					cy="250" 
					r="65" 
					class="fill-white dark:fill-slate-800 transition-colors duration-500"
					filter="url(#glow)"
				></circle>
				
				<!-- Filter for glow effect -->
				<defs>
					<filter id="glow" x="-50%" y="-50%" width="200%" height="200%">
						<feGaussianBlur stdDeviation="5" result="blur" />
						<feComposite in="SourceGraphic" in2="blur" operator="over" />
					</filter>
				</defs>

				<!-- Center text -->
				<text 
					x="250" 
					y="240" 
					text-anchor="middle" 
					font-size="24" 
					font-weight="bold"
					class="fill-slate-800 dark:fill-white transition-colors duration-500"
				>
					{currentTime.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}
				</text>
				<text 
					x="250" 
					y="270" 
					text-anchor="middle" 
					font-size="14"
					class="fill-slate-600 dark:fill-slate-300 transition-colors duration-500"
				>
					{currentTime.toLocaleDateString()}
				</text>
			</svg>
		</div>
	</div>

	<div class="time-blocks mt-8 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
		{#each timeBlocks as block, i}
			<div 
				class="relative p-5 rounded-lg border {block.urgent ? 'border-red-300 dark:border-red-700 animate-pulse' : 'border-slate-200 dark:border-slate-700'} 
				bg-white dark:bg-slate-800 shadow-sm hover:shadow-md transition-all duration-300 transform hover:-translate-y-1"
				style="animation-delay: {i * 120}ms; opacity: 0; animation: fadeSlideUp 0.5s forwards {i * 120}ms;"
			>
				<div class="flex items-center gap-4">
					<div 
						class="block-color w-14 h-14 rounded-full flex items-center justify-center shadow-inner"
						style="background-color: {block.color}; box-shadow: inset 0 2px 4px 0 rgba(0,0,0,0.1), 0 4px 6px -1px rgba(0,0,0,0.1);"
					>
						{#if block.type === 'work'}
							<svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
							</svg>
			
		{/each}
	</div>
	
	<!-- Tips Section -->
	<div class="mt-8 bg-slate-50 dark:bg-slate-700/30 p-4 rounded-lg">
		<h3 class="text-lg font-semibold text-slate-800 dark:text-white mb-2">Tips for Time Management</h3>
		<ul class="space-y-2 text-slate-600 dark:text-slate-300">
			<li class="flex items-start">
				<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-green-500 mr-2 flex-shrink-0 mt-0.5" viewBox="0 0 20 20" fill="currentColor">
					<path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
				</svg>
				<span>Schedule important tasks during your peak productivity hours of the day.</span>
			</li>
			<li class="flex items-start">
				<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-green-500 mr-2 flex-shrink-0 mt-0.5" viewBox="0 0 20 20" fill="currentColor">
					<path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
				</svg>
				<span>Take meaningful breaks to recharge - a short walk or stretching is more effective than browsing social media.</span>
			</li>
		</ul>
	</div>
</div>

<!-- Additional Information Section -->
<div class="bg-slate-50 dark:bg-slate-700/30 p-6 border-t border-slate-200 dark:border-slate-700">
	<div class="max-w-5xl mx-auto">
		<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
			<div>
				<h3 class="text-lg font-semibold text-slate-800 dark:text-white mb-3">Using This Visualizer</h3>
				<p class="text-slate-600 dark:text-slate-300 mb-3">
					This day visualizer helps you plan your time more effectively by showing a visual representation of your day.
				</p>
				<ul class="space-y-2 text-slate-600 dark:text-slate-300">
					<li class="flex items-start">
						<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-blue-500 mr-2 flex-shrink-0 mt-0.5" viewBox="0 0 20 20" fill="currentColor">
							<path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
						</svg>
						<span>Adjust the sliders to set your work, break, and sleep hours.</span>
					</li>
					<li class="flex items-start">
						<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-blue-500 mr-2 flex-shrink-0 mt-0.5" viewBox="0 0 20 20" fill="currentColor">
							<path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
						</svg>
						<span>The circle visualization shows your day divided into time segments.</span>
					</li>
					<li class="flex items-start">
						<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-blue-500 mr-2 flex-shrink-0 mt-0.5" viewBox="0 0 20 20" fill="currentColor">
							<path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
						</svg>
						<span>Red warnings appear when you don't have enough time for all planned activities.</span>
					</li>
				</ul>
			</div>
			
			<div>
				<h3 class="text-lg font-semibold text-slate-800 dark:text-white mb-3">About Time Management</h3>
				<p class="text-slate-600 dark:text-slate-300 mb-3">
					Effective time management can reduce stress, increase productivity, and improve work-life balance.
				</p>
				<ul class="space-y-2 text-slate-600 dark:text-slate-300">
					<li class="flex items-start">
						<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-purple-500 mr-2 flex-shrink-0 mt-0.5" viewBox="0 0 20 20" fill="currentColor">
							<path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
						</svg>
						<span>Adults need 7-9 hours of sleep for optimal cognitive function.</span>
					</li>
					<li class="flex items-start">
						<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-purple-500 mr-2 flex-shrink-0 mt-0.5" viewBox="0 0 20 20" fill="currentColor">
							<path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
						</svg>
						<span>Taking breaks increases overall productivity and helps maintain focus.</span>
					</li>
					<li class="flex items-start">
						<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-purple-500 mr-2 flex-shrink-0 mt-0.5" viewBox="0 0 20 20" fill="currentColor">
							<path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
						</svg>
						<span>Most people can focus deeply for only 4-5 hours per day.</span>
					</li>
				</ul>
			</div>
		</div>
		
		<div class="mt-6 text-center text-sm text-slate-500 dark:text-slate-400">
			<p>Visualization updates automatically every minute. Last updated at {currentTime.toLocaleTimeString()}</p>
		</div>
	</div>
</div>
</div>

<style>
/* Animations */
@keyframes pulse {
	0%, 100% {
		opacity: 1;
	}
	50% {
		opacity: 0.6;
	}
}

.animate-pulse {
	animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
}

@keyframes ping {
	75%, 100% {
		transform: scale(2);
		opacity: 0;
	}
}

.animate-ping {
	animation: ping 1s cubic-bezier(0, 0, 0.2, 1) infinite;
}

/* Input Range Styling */
input[type="range"] {
	-webkit-appearance: none;
	appearance: none;
	height: 8px;
	border-radius: 5px;
	background-color: #e5e7eb;
}

input[type="range"]::-webkit-slider-thumb {
	-webkit-appearance: none;
	appearance: none;
	width: 18px;
	height: 18px;
	border-radius: 50%;
	background-color: #4f46e5;
	cursor: pointer;
	transition: background-color 0.2s;
}

input[type="range"]::-moz-range-thumb {
	width: 18px;
	height: 18px;
	border-radius: 50%;
	background-color: #4f46e5;
	cursor: pointer;
	transition: background-color 0.2s;
	border: none;
}

.dark input[type="range"] {
	background-color: #4b5563;
}

.dark input[type="range"]::-webkit-slider-thumb {
	background-color: #6366f1;
}

.dark input[type="range"]::-moz-range-thumb {
	background-color: #6366f1;
}

/* Responsive adjustments */
@media (max-width: 768px) {
	.visualization-container {
		margin-top: 2rem;
	}
	
	.time-blocks {
		margin-top: 2rem;
	}
}
</style>